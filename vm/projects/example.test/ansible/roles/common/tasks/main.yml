---
# tasks file for common
- name: Install common packages
  become: True
  apt: "pkg={{ item }} state=latest"
  with_items:
  - dnsutils
  - sysstat
  - git
  - strace
- name: Configure system hostname
  become: True
  hostname: 'name={{ inventory_hostname }}'
- name: Configure system dnsdomainname
  become: True
  lineinfile: dest=/etc/hosts regexp='^127\.0\.1\.1' line='{{ hostvars[inventory_hostname].ansible_eth1.ipv4.address }}  {{ inventory_hostname }}.example.test {{ inventory_hostname }}' owner=root group=root mode=0644 state=present
- name: Enable ufw logging
  become: True
  ufw: logging=on
- name: Enable ufw rate limiting of ssh connections
  become: True
  ufw: rule=limit port=ssh proto=tcp
- name: Configure ufw to allow incoming SSH connections
  become: True
  ufw: rule=allow name=OpenSSH
- name: Enable ufw firewall
  become: True
  ufw: state=enabled
